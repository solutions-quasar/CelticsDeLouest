<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Celtics ERP | Administration</title>
    <script>
        // Force trailing slash to ensure relative paths working correctly
        if (window.location.pathname.endsWith('/admin-erp')) {
            window.location.replace(window.location.pathname + '/');
        }
    </script>
    <link rel="icon" type="image/png" href="../images/favicon.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./style_calendar.css">

    <!-- Firebase SDKs (Module) -->
    <script type="importmap">
        {
          "imports": {
            "firebase/app": "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js",
            "firebase/firestore": "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js",
            "firebase/storage": "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js",
            "firebase/auth": "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js",
            "firebase/analytics": "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js"
          }
        }
    </script>
    <!-- FullCalendar -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
    <script>
        // French translation for FullCalendar
        document.addEventListener('DOMContentLoaded', function () {
            // It will be initialized in app.js
        });
    </script>
</head>

<body>

    <div id="app">
        <!-- Auth Screen -->
        <div id="auth-screen" class="screen active">
            <div class="login-box">
                <div class="logo-area">
                    <img src="../images/logo.png" alt="Celtics Logo">
                    <h1>Celtics ERP</h1>
                </div>
                <form id="login-form">
                    <div class="input-group">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="email" placeholder="Courriel administrateur" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="password" placeholder="Mot de passe" required>
                    </div>
                    <div class="auth-options" style="text-align: left; margin-bottom: 20px; font-size: 0.9rem;">
                        <div style="margin-bottom: 8px;">
                            <input type="checkbox" id="remember-email">
                            <label for="remember-email">Se souvenir de l'email</label>
                        </div>
                        <div>
                            <input type="checkbox" id="remember-me">
                            <label for="remember-me">Rester connecté</label>
                        </div>
                    </div>
                    <button type="submit" class="btn-login"><i class="fas fa-sign-in-alt"></i> Connexion</button>
                    <div style="margin-top: 15px;">
                        <a href="#" id="forgot-password" style="color: var(--primary); font-size: 0.9rem;">Mot de passe
                            oublié ?</a>
                    </div>
                    <p id="login-error" class="error-msg"></p>
                </form>
            </div>
        </div>

        <!-- Dashboard Screen -->
        <div id="dashboard-screen" class="screen">
            <aside class="sidebar">
                <div class="sidebar-header">
                    <img src="../images/logo.png" alt="Logo">
                    <span>Admin</span>
                </div>
                <nav class="sidebar-nav">
                    <button class="nav-btn active" data-target="view-dashboard"><i class="fas fa-home"></i> Tableau de
                        bord</button>
                    <button class="nav-btn" data-target="view-teams"><i class="fas fa-users"></i> Gestion
                        Équipes</button>
                    <button class="nav-btn" data-target="view-players"><i class="fas fa-user-friends"></i>
                        Joueurs</button>
                    <button class="nav-btn" data-target="view-boutique"><i class="fas fa-store"></i> Boutique</button>
                    <button class="nav-btn" data-target="view-inventory"><i class="fas fa-clipboard-list"></i>
                        Inventaire</button>
                    <button class="nav-btn" data-target="view-board"><i class="fas fa-users-cog"></i> C.A.</button>
                    <button class="nav-btn" data-target="view-referees"><i class="fas fa-gavel"></i> Arbitres</button>
                    <button class="nav-btn" data-target="view-registrations"><i class="fas fa-file-signature"></i>
                        Inscriptions</button>
                    <button class="nav-btn" data-target="view-coaches"><i class="fas fa-stopwatch"></i> Coachs</button>
                    <button class="nav-btn" data-target="view-matches"><i class="fas fa-futbol"></i> Matchs</button>
                    <button class="nav-btn" data-target="view-sponsors"><i class="fas fa-handshake"></i>
                        Sponsors</button>
                    <button class="nav-btn" data-target="view-settings"><i class="fas fa-cogs"></i>
                        Configuration</button>
                    <button class="nav-btn" data-target="view-admins" id="nav-admins-btn" style="display:none;"><i
                            class="fas fa-users-cog"></i>
                        Utilisateurs</button>
                </nav>
                <div class="sidebar-footer">
                    <button id="logout-btn"><i class="fas fa-sign-out-alt"></i> Déconnexion</button>
                </div>
            </aside>

            <main class="main-content">
                <header class="top-bar">
                    <div class="left-top-bar">
                        <button id="mobile-menu-btn"><i class="fas fa-bars"></i></button>
                        <h2 id="page-title">Tableau de bord</h2>
                    </div>
                    <div class="user-info">
                        <span id="user-email">admin@celtics.com</span>
                        <div class="avatar"><i class="fas fa-user"></i></div>
                    </div>
                </header>

                <div id="content-area">
                    <!-- Views will be injected here -->

                    <!-- Dashboard Home -->
                    <div id="view-dashboard" class="view active">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="icon bg-blue"><i class="fas fa-tshirt"></i></div>
                                <div class="info">
                                    <h3>Produits</h3>
                                    <p id="stat-products">0</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="icon bg-green"><i class="fas fa-users"></i></div>
                                <div class="info">
                                    <h3>Joueurs</h3>
                                    <p id="stat-players">0</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="icon bg-orange"><i class="fas fa-boxes"></i></div>
                                <div class="info">
                                    <h3>Inventaire</h3>
                                    <p id="stat-inventory">0</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Teams View -->
                    <!-- Teams View -->
                    <div id="view-teams" class="view">
                        <div class="card">
                            <div class="card-header">
                                <h3>Gestion des Équipes</h3>
                                <div class="header-actions-group">
                                    <button class="view-toggle-btn active" data-view="grid" data-target="teams-list"><i
                                            class="fas fa-th-large"></i></button>
                                    <button class="view-toggle-btn" data-view="list" data-target="teams-list"><i
                                            class="fas fa-list"></i></button>
                                    <button class="btn-action" id="open-team-modal"><i class="fas fa-plus"></i>
                                        Ajouter</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="product-grid" id="teams-list">
                                    <p>Chargement...</p>
                                </div>
                                <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">
                                <details>
                                    <summary style="cursor:pointer; color:var(--primary); font-weight:500;">Générateur
                                        d'Équipes (Experimental)</summary>
                                    <div class="toolbar" style="margin-top:10px;">
                                        <button class="btn-secondary" id="generate-teams-btn">Générer les
                                            équipes</button>
                                        <select id="team-size-select">
                                            <option value="5">5 vs 5</option>
                                            <option value="7">7 vs 7</option>
                                            <option value="9">9 vs 9</option>
                                            <option value="11">11 vs 11</option>
                                        </select>
                                    </div>
                                    <div class="table-container">
                                        <table id="players-table">
                                            <thead>
                                                <tr>
                                                    <th>Nom</th>
                                                    <th>Âge</th>
                                                    <th>Niveau</th>
                                                    <th>Position</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- JS will populate -->
                                            </tbody>
                                        </table>
                                    </div>
                                    <div id="generated-teams-result" class="teams-output"></div>
                                </details>
                            </div>
                        </div>
                    </div>



                    <!-- Players View (new module) -->
                    <div id="view-players" class="view">
                        <div class="card">
                            <div class="card-header">
                                <h3>Gestion des Joueurs</h3>
                                <div class="header-actions-group">
                                    <button class="view-toggle-btn active" data-view="grid"
                                        data-target="players-directory-list"><i class="fas fa-th-large"></i></button>
                                    <button class="view-toggle-btn" data-view="list"
                                        data-target="players-directory-list"><i class="fas fa-list"></i></button>
                                    <button class="btn-action" id="open-player-modal-directory"><i
                                            class="fas fa-plus"></i></button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="product-grid" id="players-directory-list">
                                    <!-- JS will populate -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Boutique View -->
                    <div id="view-boutique" class="view">
                        <div class="card">
                            <div class="card-header">
                                <h3>Gestion Boutique</h3>
                                <div class="header-actions-group">
                                    <button class="view-toggle-btn active" data-view="grid"
                                        data-target="products-list"><i class="fas fa-th-large"></i></button>
                                    <button class="view-toggle-btn" data-view="list" data-target="products-list"><i
                                            class="fas fa-list"></i></button>
                                    <button class="btn-action" id="open-product-modal"><i
                                            class="fas fa-plus"></i></button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="product-grid" id="products-list">
                                    <!-- JS will populate -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Inventory View -->
                    <div id="view-inventory" class="view">
                        <div class="card">
                            <div class="card-header">
                                <h3>Inventaire Matériel</h3>
                                <div class="header-actions-group">
                                    <button class="view-toggle-btn active" data-view="grid"
                                        data-target="inventory-container-div"><i class="fas fa-th-large"></i></button>
                                    <button class="view-toggle-btn" data-view="list"
                                        data-target="inventory-container-div"><i class="fas fa-list"></i></button>
                                    <button class="btn-action" id="open-inventory-modal"><i
                                            class="fas fa-plus"></i></button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-container">
                                    <table id="inventory-table">
                                        <thead>
                                            <tr>
                                                <th>Article</th>
                                                <th>Catégorie</th>
                                                <th>Quantité</th>
                                                <th>État</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- JS will populate -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- BOARD VIEW -->
                    <div id="view-board" class="view">
                        <div class="card">
                            <div class="card-header">
                                <h3>Conseil d'Administration</h3>
                                <div class="header-actions-group">
                                    <button class="view-toggle-btn active" data-view="grid" data-target="board-list"><i
                                            class="fas fa-th-large"></i></button>
                                    <button class="view-toggle-btn" data-view="list" data-target="board-list"><i
                                            class="fas fa-list"></i></button>
                                    <button class="btn-action" id="open-board-modal"><i
                                            class="fas fa-plus"></i></button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="product-grid" id="board-list">
                                    <!-- JS Will Populate -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- REFEREES VIEW -->
                    <div id="view-referees" class="view">
                        <div class="card">
                            <div class="card-header">
                                <h3>Gestion des Arbitres</h3>
                                <div class="header-actions-group">
                                    <button class="view-toggle-btn active" data-view="grid"
                                        data-target="referees-list"><i class="fas fa-th-large"></i></button>
                                    <button class="view-toggle-btn" data-view="list" data-target="referees-list"><i
                                            class="fas fa-list"></i></button>
                                    <button class="btn-action" id="open-referee-modal"><i
                                            class="fas fa-plus"></i></button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="product-grid" id="referees-list">
                                    <!-- JS Will Populate -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- REGISTRATIONS VIEW -->
                    <div id="view-registrations" class="view">
                        <div class="card">
                            <div class="card-header">
                                <h3>Demandes d'inscription</h3>
                                <button class="btn-action" id="open-registration-modal"><i class="fas fa-plus"></i>
                                    Nouvelle Inscription</button>
                            </div>
                            <div class="card-body">
                                <div class="table-container">
                                    <table id="registrations-table">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Enfant</th>
                                                <th>Programme</th>
                                                <th>Parent</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- JS Will Populate -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- COACHS VIEW -->
                    <div id="view-coaches" class="view">
                        <div class="card">
                            <div class="card-header">
                                <h3>Gestion des Entraîneurs</h3>
                                <button class="btn-action" id="open-coach-modal"><i class="fas fa-plus"></i> Ajouter
                                    Coach</button>
                            </div>
                            <div class="card-body">
                                <div id="coaches-list" class="grid-container">
                                    <p>Chargement...</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- MATCHS VIEW -->
                    <div id="view-matches" class="view">
                        <div class="card">
                            <div class="card-header">
                                <h3>Calendrier des Matchs (Domicile)</h3>
                                <div class="header-actions-group">
                                    <button class="view-toggle-btn active" data-view="calendar"
                                        data-target="matches-view-container"><i
                                            class="fas fa-calendar-alt"></i></button>
                                    <button class="view-toggle-btn" data-view="list"
                                        data-target="matches-view-container"><i class="fas fa-list"></i></button>
                                    <button class="btn-action" id="open-match-modal"><i class="fas fa-plus"></i>
                                        Ajouter</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="matches-view-container">
                                    <!-- Calendar View -->
                                    <div id="calendar-view" class="sub-view active">
                                        <div id="calendar"></div>
                                    </div>

                                    <!-- List View -->
                                    <div id="matches-list" class="match-grid sub-view" style="display:none;">
                                        <p>Chargement des matchs...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SPONSORS VIEW -->
                    <div id="view-sponsors" class="view">
                        <div class="card">
                            <div class="card-header">
                                <h3>Gestion des Sponsors</h3>
                                <button class="btn-action" id="open-sponsor-modal"><i class="fas fa-plus"></i>
                                    Ajouter</button>
                            </div>
                            <div class="card-body">
                                <div id="sponsors-list" class="view-grid">
                                    <p>Chargement...</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SETTINGS VIEW (Configuration) -->
                    <div id="view-settings" class="view">
                        <div class="card">
                            <div class="card-header">
                                <h3>Configuration & Inscriptions</h3>
                                <button class="btn-save" id="save-settings-btn"><i class="fas fa-save"></i>
                                    Sauvegarder Tout</button>
                            </div>
                            <div class="card-body">
                                <!-- Status Section -->
                                <div class="form-group"
                                    style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 5px solid var(--secondary);">
                                    <label style="display:flex; align-items:center; cursor:pointer;">
                                        <input type="checkbox" id="reg-status-toggle"
                                            style="width:20px; height:20px; margin-right:10px;">
                                        <span style="font-weight:bold; font-size:1.1rem;">Ouvrir la période
                                            d'inscriptions</span>
                                    </label>
                                    <p class="text-sm" style="margin-top:5px; color:#666;">Cocher pour rendre le
                                        formulaire visible sur le site public.</p>
                                </div>

                                <!-- Text Section -->
                                <div class="form-group">
                                    <label>Message d'accueil (Inscriptions)</label>
                                    <textarea id="setting-welcome-msg" rows="8"
                                        style="width:100%; border:1px solid #ddd; padding:10px; border-radius:4px;"></textarea>
                                </div>

                                <!-- Global Discounts -->
                                <div class="row">
                                    <div class="col-6">
                                        <div class="form-group">
                                            <label>Rabais 2ème enfant ($)</label>
                                            <input type="number" id="setting-discount-2" value="15">
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="form-group">
                                            <label>Rabais 3ème enfant + ($)</label>
                                            <input type="number" id="setting-discount-3" value="20">
                                        </div>
                                    </div>
                                </div>

                                <hr>

                                <!-- Pricing Grid -->
                                <h4>Grille Tarifaire (Par année de naissance)</h4>
                                <div class="table-container">
                                    <table id="pricing-table">
                                        <thead>
                                            <tr>
                                                <th>Année</th>
                                                <th>Catégorie</th>
                                                <th>Prix ($)</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="pricing-tbody">
                                            <!-- JS Populated -->
                                        </tbody>
                                    </table>
                                    <button class="btn-secondary" id="add-price-row-btn" style="margin-top:10px;"><i
                                            class="fas fa-plus"></i> Ajouter une année</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ADMINS VIEW -->
                    <div id="view-admins" class="view">
                        <div class="card">
                            <div class="card-header">
                                <h3>Gestion des Utilisateurs</h3>
                                <button class="btn-action" id="open-admin-modal"><i class="fas fa-user-plus"></i>
                                    Ajouter Utilisateur</button>
                            </div>
                            <div class="card-body">
                                <div class="table-container">
                                    <table id="admins-table">
                                        <thead>
                                            <tr>
                                                <th>Email</th>
                                                <th>Nom</th>
                                                <th>Rôle</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- JS Will Populate -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </main>
        </div>
    </div>

    <!-- Modals -->
    <!-- Product Modal -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="product-modal-title">Ajouter un produit</h2>
            <form id="product-form">
                <input type="hidden" id="product-id">
                <div class="form-group">
                    <label>Nom du produit</label>
                    <input type="text" id="prod-name" required>
                </div>
                <div class="form-group">
                    <label>Prix ($)</label>
                    <input type="number" id="prod-price" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Image</label>
                    <input type="file" id="prod-image" accept="image/*">
                    <div id="prod-image-preview" class="image-preview-container image-preview-mt"></div>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="prod-desc" rows="3"></textarea>
                </div>
                <button type="submit" class="btn-save">Enregistrer</button>
            </form>
        </div>
    </div>

    <!-- Player Modal -->
    <div id="player-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Joueur</h2>
            <form id="player-form">
                <input type="hidden" id="player-id">
                <div class="form-group">
                    <label>Nom Complet</label>
                    <input type="text" id="player-name" required>
                </div>
                <div class="form-group">
                    <label>Année de Naissance</label>
                    <input type="number" id="player-year" required>
                </div>
                <div class="form-group">
                    <label>Niveau (1: Débutant - 10: Expert)</label>
                    <input type="number" id="player-skill" min="1" max="10" value="5" required>
                </div>
                <div class="form-group">
                    <label>Position Préférée</label>
                    <select id="player-pos">
                        <option value="Attaquant">Attaquant</option>
                        <option value="Milieu">Milieu</option>
                        <option value="Défenseur">Défenseur</option>
                        <option value="Gardien">Gardien</option>
                        <option value="Polyvalent">Polyvalent</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Équipe</label>
                    <select id="player-team">
                        <option value="">-- Aucune --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Photo (Optionnel)</label>
                    <input type="file" id="player-image" accept="image/*">
                    <div id="player-image-preview" class="image-preview-container image-preview-mt"></div>
                </div>
                <button type="submit" class="btn-save">Enregistrer</button>
            </form>
        </div>
    </div>

    <!-- Inventory Modal -->
    <div id="inventory-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Article d'Inventaire</h2>
            <form id="inventory-form">
                <input type="hidden" id="inv-id">
                <div class="form-group">
                    <label>Nom de l'article</label>
                    <input type="text" id="inv-name" placeholder="Ex: Ballons Taille 4" required>
                </div>
                <div class="form-group">
                    <label>Catégorie</label>
                    <select id="inv-cat">
                        <option value="Ballons">Ballons</option>
                        <option value="Vêtements">Vêtements</option>
                        <option value="Entraînement">Matériel d'entraînement</option>
                        <option value="Terrain">Terrain (Filets, Drapeaux)</option>
                        <option value="Autre">Autre</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Quantité</label>
                    <input type="number" id="inv-qty" required>
                </div>
                <div class="form-group">
                    <label>État</label>
                    <select id="inv-status">
                        <option value="Neuf">Neuf</option>
                        <option value="Bon">Bon</option>
                        <option value="Usé">Usé</option>
                        <option value="À remplacer">À remplacer</option>
                    </select>
                </div>
                <div class="form-group"
                    style="background: #f8f9fa; padding: 10px; border-radius: 6px; margin-bottom: 15px;">
                    <label style="display:flex; justify-content:space-between; align-items:center;">
                        Distribution du Stock
                        <span id="inv-stock-remaining"
                            style="font-size: 0.9em; background: var(--primary); color: white; padding: 2px 8px; border-radius: 12px;">Stock:
                            -</span>
                    </label>

                    <!-- Add Distribution Form -->
                    <div style="display: flex; gap: 5px; margin-bottom: 15px; flex-wrap: wrap;">
                        <select id="dist-type" style="flex: 1; min-width: 100px; font-size: 0.85rem;">
                            <option value="">Type...</option>
                            <option value="coach">Coach</option>
                            <option value="player">Joueur</option>
                        </select>
                        <select id="dist-target" style="flex: 2; min-width: 150px; font-size: 0.85rem;" disabled>
                            <option value="">Sélectionner...</option>
                        </select>
                        <input type="number" id="dist-qty" placeholder="Qté" min="1"
                            style="width: 60px; font-size: 0.85rem;">
                        <button type="button" id="btn-add-dist" class="btn-save"
                            style="width: auto; padding: 5px 10px; font-size: 0.9rem;">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>

                    <!-- Distributions List -->
                    <div id="inv-distributions-list"
                        style="max-height: 150px; overflow-y: auto; background: white; border: 1px solid #eee; border-radius: 4px; padding: 5px;">
                        <p style="color: #888; font-style: italic; font-size: 0.9rem;">Aucune distribution.</p>
                    </div>
                </div>
                <button type="submit" class="btn-save">Enregistrer</button>
            </form>
        </div>
    </div>

    <!-- BOARD MODAL -->
    <div class="modal" id="board-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Membre du Conseil</h2>
            <form id="board-form">
                <input type="hidden" id="board-id">
                <div class="form-group">
                    <label>Nom Complet</label>
                    <input type="text" id="board-name" required>
                </div>
                <div class="form-group">
                    <label>Rôle (ex: Président, Trésorière)</label>
                    <input type="text" id="board-role" required>
                </div>
                <div class="form-group">
                    <label>Photo de profil</label>
                    <input type="file" id="board-image" accept="image/*">
                    <!-- PREVIEW CONTAINER Added -->
                    <div id="board-image-preview" class="image-preview-container image-preview-mt"></div>
                </div>
                <div class="form-group">
                    <label>Ordre d'affichage (1 = Premier)</label>
                    <input type="number" id="board-order" value="99">
                </div>
                <!-- ACTIVE CHECKBOX -->
                <div class="form-group" style="background:#f9f9f9; padding:10px; border-radius:6px; margin-top:10px;">
                    <label style="display:flex; align-items:center; cursor:pointer; margin-bottom:0;">
                        <input type="checkbox" id="board-visible" style="width:20px; height:20px; margin-right:10px;"
                            checked>
                        <span>Afficher sur le site (Actif)</span>
                    </label>
                </div>
                <button type="submit" class="btn-save">Enregistrer</button>
            </form>
        </div>
    </div>

    <!-- REFEREE MODAL -->
    <div class="modal" id="referee-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Arbitre</h2>
            <form id="referee-form">
                <input type="hidden" id="referee-id">
                <div class="form-group">
                    <label>Nom Complet</label>
                    <input type="text" id="ref-name" required>
                </div>
                <div class="form-group">
                    <label>Photo (Optionnel)</label>
                    <input type="file" id="ref-image" accept="image/*">
                    <div id="ref-image-preview" class="image-preview-container image-preview-mt"></div>
                </div>

                <div class="form-group" style="background:#f9f9f9; padding:10px; border-radius:6px; margin-top:10px;">
                    <label style="display:flex; align-items:center; cursor:pointer; margin-bottom:0;">
                        <input type="checkbox" id="ref-visible" style="width:20px; height:20px; margin-right:10px;"
                            checked>
                        <span>Arbitre actif (Afficher sur le site)</span>
                    </label>
                </div>

                <div id="ref-matches-container"
                    style="margin-bottom: 15px; border-top: 1px solid #eee; padding-top: 10px;">
                    <label style="font-weight: 500; display: block; margin-bottom: 5px;">Matchs Assignés</label>
                    <div id="ref-matches-list"
                        style="max-height: 150px; overflow-y: auto; background: #f9f9f9; padding: 10px; border-radius: 6px; font-size: 0.9rem; margin-bottom: 10px;">
                        <p style="color: #888; font-style: italic;">Aucun match assigné.</p>
                    </div>

                    <div
                        style="display: flex; gap: 5px; align-items: center; border-top: 1px dashed #ddd; padding-top: 10px;">
                        <select id="ref-assign-match-select"
                            style="flex: 2; padding: 6px; border-radius: 4px; border: 1px solid #ccc; font-size: 0.85rem;">
                            <option value="">Choisir un match...</option>
                        </select>
                        <select id="ref-assign-role-select"
                            style="flex: 1; padding: 6px; border-radius: 4px; border: 1px solid #ccc; font-size: 0.85rem;">
                            <option value="refCenter">Principal</option>
                            <option value="refAsst1">Assistant 1</option>
                            <option value="refAsst2">Assistant 2</option>
                        </select>
                        <button type="button" id="btn-assign-match"
                            style="background: var(--primary); color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>

                <button type="submit" class="btn-save">Enregistrer</button>
            </form>
        </div>
    </div>

    <!-- REGISTRATION MODAL -->
    <div class="modal" id="registration-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Détails Inscription</h2>
            <form id="registration-form-admin">
                <input type="hidden" id="reg-id">
                <div class="form-group">
                    <label>Enfant (Prénom / Nom)</label>
                    <div style="display:flex; gap:10px;">
                        <input type="text" id="reg-child-first" placeholder="Prénom" required>
                        <input type="text" id="reg-child-last" placeholder="Nom" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Parent (Prénom / Nom)</label>
                    <div style="display:flex; gap:10px;">
                        <input type="text" id="reg-parent-first" placeholder="Prénom" required>
                        <input type="text" id="reg-parent-last" placeholder="Nom" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Contact</label>
                    <input type="email" id="reg-email" placeholder="Courriel" required>
                    <input type="tel" id="reg-phone" placeholder="Téléphone" style="margin-top:5px;">
                </div>
                <div class="form-group">
                    <label>Programme</label>
                    <select id="reg-program" required>
                        <option value="U4-U6">Timbits (U4-U6)</option>
                        <option value="U7-U10">LSCP (U7-U10)</option>
                        <option value="U11-U12">Ligue de Développement (U11-U12)</option>
                        <option value="U13-U18">Compétitif (U13-U18)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Statut</label>
                    <select id="reg-status">
                        <option value="New">Nouveau</option>
                        <option value="Paid">Payé</option>
                        <option value="Completed">Terminé</option>
                    </select>
                </div>
                <button type="submit" class="btn-save">Enregistrer</button>
            </form>
        </div>
    </div>

    <!-- ADMIN MODAL -->
    <div class="modal" id="admin-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Utilisateur Plateforme</h2>
            <form id="admin-form">
                <input type="hidden" id="admin-id">
                <div class="form-group">
                    <label>Email (ID de connexion)</label>
                    <input type="email" id="admin-email" required>
                </div>
                <div class="form-group">
                    <label>Nom</label>
                    <input type="text" id="admin-name" required>
                </div>
                <div class="form-group">
                    <label>Rôles / Permissions</label>
                    <div id="roles-checkbox-group"
                        style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; background: #f9f9f9; padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
                        <label
                            style="display:flex; align-items:center; font-weight:normal; font-size:0.9rem; cursor:pointer;">
                            <input type="checkbox" value="SuperAdmin"
                                style="width:18px; height:18px; margin-right:8px;"> SuperAdmin (Accès total)
                        </label>
                        <label
                            style="display:flex; align-items:center; font-weight:normal; font-size:0.9rem; cursor:pointer;">
                            <input type="checkbox" value="Equipes" style="width:18px; height:18px; margin-right:8px;">
                            Équipes & Coachs
                        </label>
                        <label
                            style="display:flex; align-items:center; font-weight:normal; font-size:0.9rem; cursor:pointer;">
                            <input type="checkbox" value="Boutique" style="width:18px; height:18px; margin-right:8px;">
                            Boutique & Inventaire
                        </label>
                        <label
                            style="display:flex; align-items:center; font-weight:normal; font-size:0.9rem; cursor:pointer;">
                            <input type="checkbox" value="Club" style="width:18px; height:18px; margin-right:8px;"> C.A.
                            & Arbitres
                        </label>
                        <label
                            style="display:flex; align-items:center; font-weight:normal; font-size:0.9rem; cursor:pointer;">
                            <input type="checkbox" value="Inscriptions"
                                style="width:18px; height:18px; margin-right:8px;"> Inscriptions
                        </label>
                        <label
                            style="display:flex; align-items:center; font-weight:normal; font-size:0.9rem; cursor:pointer;">
                            <input type="checkbox" value="Matchs" style="width:18px; height:18px; margin-right:8px;">
                            Matchs (Calendrier)
                        </label>
                        <label
                            style="display:flex; align-items:center; font-weight:normal; font-size:0.9rem; cursor:pointer;">
                            <input type="checkbox" value="Config" style="width:18px; height:18px; margin-right:8px;">
                            Configuration
                        </label>
                    </div>
                </div>
                <button type="submit" class="btn-save">Enregistrer</button>
            </form>
        </div>
    </div>

    <!-- Coach Modal -->
    <div class="modal" id="coach-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Entraîneur</h2>
            <form id="coach-form">
                <input type="hidden" id="coach-id">

                <div class="form-group">
                    <label>Nom Complet</label>
                    <input type="text" id="coach-name" required>
                </div>

                <div class="form-group">
                    <label>Expiration Filiation Policière</label>
                    <input type="date" id="coach-police-expiry">
                    <small>Date à laquelle la vérification expire.</small>
                </div>

                <div class="form-group">
                    <label>Photo</label>
                    <input type="file" id="coach-image" accept="image/*">
                    <div id="coach-image-preview" class="image-preview-container image-preview-mt"></div>
                </div>

                <div class="form-group" style="background:#f9f9f9; padding:10px; border-radius:6px; margin-top:10px;">
                    <label style="display:flex; align-items:center; cursor:pointer; margin-bottom:0;">
                        <input type="checkbox" id="coach-visible" style="width:20px; height:20px; margin-right:10px;"
                            checked>
                        <span>Coach actif (Afficher sur le site)</span>
                    </label>
                </div>

                <!-- Assigned Inventory -->
                <div id="coach-inventory-container"
                    style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 10px;">
                    <label style="font-weight: 500; display: block; margin-bottom: 5px;">Inventaire Assigné</label>
                    <div id="coach-inventory-list"
                        style="max-height: 150px; overflow-y: auto; background: #f9f9f9; padding: 10px; border-radius: 6px; font-size: 0.9rem; margin-bottom: 10px;">
                        <p style="color: #888; font-style: italic;">Chargement...</p>
                    </div>
                </div>

                <!-- Assigned Teams -->
                <div id="coach-teams-container"
                    style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 10px; margin-bottom: 15px;">
                    <label style="font-weight: 500; display: block; margin-bottom: 5px;">Équipes Assignées</label>
                    <div id="coach-teams-list"
                        style="max-height: 100px; overflow-y: auto; background: #f9f9f9; padding: 10px; border-radius: 6px; font-size: 0.9rem;">
                        <p style="color: #888; font-style: italic;">Fonctionnalité en développement.</p>
                    </div>
                </div>

                <button type="submit" class="btn-save">Enregistrer</button>
                <button type="button" class="btn-secondary" id="close-coach-modal-btn"
                    style="margin-top: 10px; width: 100%; background: white; border: 1px solid var(--primary, #00563B); color: var(--primary, #00563B);">Fermer</button>
            </form>
        </div>
    </div>

    <!-- Match Modal -->
    <div class="modal" id="match-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Détails du Match</h2>
            <form id="match-form">
                <input type="hidden" id="match-id">
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="match-date" required>
                </div>
                <div class="form-group">
                    <label>Heure</label>
                    <input type="time" id="match-time" required>
                </div>
                <div class="form-group">
                    <label>Catégorie</label>
                    <select id="match-category">
                        <option value="U9">U9</option>
                        <option value="U10">U10</option>
                        <option value="U11">U11</option>
                        <option value="U12">U12</option>
                        <option value="U13">U13</option>
                        <option value="U14">U14</option>
                        <option value="U15">U15</option>
                        <option value="U16">U16</option>
                        <option value="U17">U17</option>
                        <option value="U18">U18</option>
                        <option value="Senior">Senior</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Adversaire</label>
                    <input type="text" id="match-opponent" placeholder="Ex: CS Dieppe, Codiac..." required>
                </div>
                <div class="form-group">
                    <label>Terrain</label>
                    <input type="text" id="match-field" value="Terrain Principal" required>
                </div>
                <hr style="margin: 15px 0;">
                <h4>Assignation Arbitres</h4>
                <div class="form-group">
                    <label>Arbitre Central</label>
                    <select id="match-ref-center">
                        <option value="">-- Non assigné --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Assistant 1</label>
                    <select id="match-ref-asst1">
                        <option value="">-- Non assigné --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Assistant 2</label>
                    <select id="match-ref-asst2">
                        <option value="">-- Non assigné --</option>
                    </select>
                </div>

                <button type="submit" class="btn-save">Enregistrer</button>
            </form>
        </div>
    </div>

    <!-- SPONSOR MODAL -->
    <div class="modal" id="sponsor-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Sponsor</h2>
            <form id="sponsor-form">
                <input type="hidden" id="sponsor-id">
                <div class="form-group">
                    <label>Nom de l'entreprise</label>
                    <input type="text" id="sponsor-name" required>
                </div>
                <div class="form-group">
                    <label>Logo</label>
                    <input type="file" id="sponsor-image" accept="image/*">
                    <div id="sponsor-image-preview" class="image-preview-container image-preview-mt"></div>
                </div>
                <div class="form-group">
                    <label>Lien site web</label>
                    <input type="url" id="sponsor-url" placeholder="https://...">
                </div>
                <div class="form-group" style="background:#f9f9f9; padding:10px; border-radius:6px; margin-top:10px;">
                    <label style="display:flex; align-items:center; cursor:pointer;">
                        <input type="checkbox" id="sponsor-visible" style="width:20px; height:20px; margin-right:10px;"
                            checked>
                        <span>Afficher sur le site</span>
                    </label>
                </div>
                <button type="submit" class="btn-save">Enregistrer</button>
            </form>
        </div>
    </div>

    <!-- Team Modal -->
    <div class="modal" id="team-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Détails Équipe</h2>
            <form id="team-form">
                <input type="hidden" id="team-id">
                <div class="form-group">
                    <label>Nom de l'équipe</label>
                    <input type="text" id="team-name" placeholder="Ex: U10 Rouge" required>
                </div>
                <div class="form-group">
                    <label>Catégorie</label>
                    <select id="team-category">
                        <option value="U4-U6">U4-U6 (Timbits)</option>
                        <option value="U7-U8">U7-U8</option>
                        <option value="U9-U10">U9-U10</option>
                        <option value="U11-U12">U11-U12</option>
                        <option value="U13-U15">U13-U15</option>
                        <option value="U16-U18">U16-U18</option>
                        <option value="Senior">Senior</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Entraîneur</label>
                    <select id="team-coach">
                        <option value="">-- Aucun --</option>
                    </select>
                </div>

                <!-- Assigned Players -->
                <div id="team-players-container"
                    style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 10px; margin-bottom: 15px;">
                    <label style="font-weight: 500; display: block; margin-bottom: 5px;">Joueurs</label>
                    <div id="team-players-list"
                        style="max-height: 200px; overflow-y: auto; background: #f9f9f9; padding: 10px; border-radius: 6px; font-size: 0.9rem; margin-bottom: 10px;">
                        <p style="color: #888; font-style: italic;">Chargement...</p>
                    </div>

                    <!-- Add Player Section -->
                    <div
                        style="display: flex; gap: 5px; align-items: center; border-top: 1px dashed #ddd; padding-top: 10px;">
                        <select id="team-add-player-select"
                            style="flex: 1; padding: 6px; border-radius: 4px; border: 1px solid #ccc; font-size: 0.85rem;">
                            <option value="">Ajouter un joueur...</option>
                        </select>
                        <button type="button" id="btn-add-player-to-team"
                            style="background: var(--primary); color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>

                <button type="submit" class="btn-save">Enregistrer</button>
            </form>
        </div>
    </div>

    <!-- Custom Notification/Confirmation Modals -->
    <div id="custom-alert-modal" class="modal">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <span class="close-modal"
                onclick="document.getElementById('custom-alert-modal').classList.remove('active')">&times;</span>
            <div style="margin: 20px 0;">
                <i id="alert-icon" class="fas fa-info-circle" style="font-size: 3rem; color: var(--primary);"></i>
            </div>
            <p id="alert-message" style="font-size: 1.1rem; margin: 20px 0;"></p>
            <button onclick="document.getElementById('custom-alert-modal').classList.remove('active')" class="btn-save"
                style="margin-top: 10px;">OK</button>
        </div>
    </div>

    <div id="custom-confirm-modal" class="modal">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <span class="close-modal"
                onclick="document.getElementById('custom-confirm-modal').classList.remove('active')">&times;</span>
            <div style="margin: 20px 0;">
                <i class="fas fa-question-circle" style="font-size: 3rem; color: var(--warning);"></i>
            </div>
            <p id="confirm-message" style="font-size: 1.1rem; margin: 20px 0;"></p>
            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 20px;">
                <button id="confirm-cancel-btn" class="btn-secondary"
                    style="background: #6c757d; flex: 1;">Annuler</button>
                <button id="confirm-ok-btn" class="btn-save" style="flex: 1;">Confirmer</button>
            </div>
        </div>
    </div>

    <!-- Main Logic -->
    <script type="module" src="./js/app.js?v=1.6"></script>
</body>

</html>